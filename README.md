# OBIC7 勤怠入力の効率化ツール

OBIC7勤務表ページで「出勤/退勤打刻」の時刻を「出勤/退勤」欄に一括でコピーするUserScriptです。

## 🎯 機能概要

- **一括時刻コピー**: 打刻時刻から勤務時間への自動転記
- **安全な処理**: 既に入力済みの時刻は上書きしません
- **直感的な操作**: 「打刻コピー」ボタン一回のクリックで完了
- **OBIC7専用**: ObSpread APIを直接利用した高い互換性

## 📋 対応環境

- **対象システム**: OBIC7個人別勤務表入力ページ
- **ブラウザ**: Chrome、Firefox、Edge（Tampermonkey/Greasemonkey必須）
- **URL**: `*://*/JACWeb30Sat/I003_KozinbetuKinmuhyou2.aspx*`

## 🚀 インストール手順

### 1. Tampermonkeyの導入

1. ブラウザの拡張機能ストアで「Tampermonkey」を検索
2. Tampermonkeyをインストールして有効化（Chrome系ブラウザでTampermonkey拡張機能（バージョン5.3+）を使用する場合、「ユーザースクリプトを許可」トグル（Chrome 138+では拡張機能の設定から利用可能）または開発者モードのいずれかを有効にする必要があります。）

### 2. UserScriptのインストール

1. Tampermonkeyのダッシュボードを開く
2. 「新しいスクリプトを作成」をクリック
3. `obic7-userscript.js` の内容をコピー&ペースト
4. Ctrl+S (Cmd+S) で保存

### 3. 動作確認

1. OBIC7の勤務表ページを開く
2. 「表示」ボタンの隣にオレンジ色の「打刻コピー」ボタンが表示されることを確認

## 💡 使用方法

1. **勤務表ページを開く**: OBIC7で個人別勤務表入力ページにアクセス
2. **ボタンをクリック**: 「打刻コピー」ボタンをクリック
3. **処理結果を確認**: 完了ダイアログでコピー件数を確認

### 処理内容

- **出勤打刻** → **出勤** 欄への自動転記
- **退勤打刻** → **退勤** 欄への自動転記
- 既に入力済みの時刻は保護（上書きなし）

## 🔧 技術仕様

### コア技術
- **UserScript**: Tampermonkey/Greasemonkey環境
- **ObSpread API**: OBIC7標準のスプレッドシートコンポーネント
- **直接DOM操作**: ページ環境での実行による高い互換性

### 列インデックス定義
```javascript
const cols = {
    CLOCK_IN_SOURCE: 63,    // 出勤打刻列
    CLOCK_OUT_SOURCE: 65,   // 退勤打刻列
    WORK_START_TARGET: 68,  // 出勤目標列
    WORK_END_TARGET: 70     // 退勤目標列
};
```

## 🛠️ トラブルシューティング

### ボタンが表示されない場合

1. **ページURL確認**: 対象URLパターンに一致しているか確認
2. **Tampermonkey有効確認**: 拡張機能が有効になっているか確認
3. **スクリプト有効確認**: UserScriptが有効になっているか確認
4. **ページ再読込**: F5キーでページを再読込

### エラーが発生する場合

1. **コンソール確認**: F12キーでデベロッパーツールを開き、コンソールでエラー詳細を確認
2. **ObSpread待機**: ページ完全読込後（最大30秒）に再試行
3. **ブラウザ再起動**: ブラウザを完全に再起動

### よくある問題

| 症状 | 原因 | 対処法 |
|------|------|--------|
| ボタンが表示されない | URLが不一致 | 正しい勤務表ページか確認 |
| 処理が実行されない | ObSpread未読込 | ページ読込完了まで待機 |
| 一部の時刻がコピーされない | 既に入力済み | 仕様通り（上書き防止） |

## 📁 ファイル構成

```
fxxkObic7/
├── obic7-userscript.js           # メインUserScript
├── README.md                     # 本ドキュメント
├── CLAUDE.md                     # 開発者向けドキュメント
├── obic7-auto-fill-specification.md  # 仕様書
├── gemini-obic7.md              # 分析資料
└── LICENSE                      # ライセンス
```

## 📝 更新履歴

### v3.1 (2025-08-01)
- UserScript版に完全移行
- ObSpread API直接連携による高い互換性を実現
- 弾出ウィンドウ対応
- 日本語コメント・ドキュメント整備

### v1.0.0 (2025-07-27)
- 初回リリース（Chrome拡張版）
- 基本的な打刻データコピー機能

## 📝 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 🤝 貢献・サポート

改善提案やバグレポートは、GitHubのIssuesまでお願いします。

---

**⚠️ 注意**: この効率化ツールは業務改善を目的として開発されています。勤務時間の記録は必ず正確性を確認してから提出してください。

*OBIC7 勤怠入力の効率化ツール v3.1*
